{% comment %} Description: Petition page that scrolls down to share. {% endcomment %}
{% comment %} Primary layout: true {% endcomment %}

{% include 'Small Header' %}

<div class="center-content center-content--accomodates-stuck-footer">
  <div class="center-content__big-column">
    <div class="mobile-show pre-main-bar">{% include 'Thermometer' %}</div>

    {% include 'Body Text' %}
  </div>
  <div class="center-content__fixed-right center-content--push-down">
    {% include 'Petition Sidebar', extra_class: 'stuck-right not-sticky' %}
  </div>
</div>

<div class="center-content center-content--accomodates-stuck-footer petition-and-scroll-to-share__yes-no-question-wrapper">
  <div class="center-content__one-column">

    <div class="center-content__central-square">

      {% capture message %}{{ 'petition.thank_you' | val: 'petition_title', title | t }}{% endcapture %}
      <h1 class="thank-you__thanks">{{ message }}</h1>
      <div class="thank-you__cta">
        <span class="two-step__question">{{ 'share.two_step.cta' | t }}</span>
        <span class="two-step__declined hidden-closed">{{ 'share.two_step.declined' | t }}</span>
        <span class="two-step__accepted hidden-closed">{{ 'share.two_step.accepted' | t }}</span>
      </div>

      <div class="center-content__centered-element">
        <div class="two-step__question">
          <div class="share-buttons">
            <div class="share-buttons__button button two-step__button two-step__accept">
              {{ 'share.two_step.accept' | t }}
            </div>
            <div class="share-buttons__button button two-step__button two-step__decline">
              {{ 'share.two_step.decline' | t }}
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>

<div class="center-content center-content--accomodates-stuck-footer petition-and-scroll-to-share__share-wrapper">
  <div class="center-content__one-column">

    <div class="center-content__central-square">

      <div class="thank-you__cta">{{ 'share.cta' | t }}</div>

      <div class="center-content__centered-element">
        {% include 'Share' %}
      </div>
    </div>

  </div>
</div>

{% include 'Petition Mobile Footer' %}
{% include 'Small Image Footer' %}

<script type="text/javascript">
  $(document).ready(function(){
    var petitionSidebar = $('.center-content__fixed-right');
    var yesNoQuestion = $('.petition-and-scroll-to-share__yes-no-question-wrapper');
    var shareStep = $('.petition-and-scroll-to-share__share-wrapper');

    new window.champaign.Petition({
      redirectAfterAction: false,
      submissionCallback: petitionCallback
    });

    $('.two-step__accept').click(displayAndScrollToShare);
    $('.two-step__decline').click(displayAndScrollToDonate);

    function petitionCallback(e, data) {
      petitionSidebar.fadeOut();
      yesNoQuestion.css('margin-bottom', window.innerHeight - yesNoQuestion.height());
      yesNoQuestion.fadeIn();
      scrollTo(yesNoQuestion);
    }

    function displayAndScrollToShare() {
      shareStep.fadeIn();
      shareStep.css('margin-bottom', window.innerHeight - shareStep.height());
      scrollTo(shareStep);
    }

    function displayAndScrollToDonate() {
      alert('donate');
    }

    function scrollTo(element) {
      $('html, body').animate({scrollTop: element.offset().top}, 800);
    }

  });
</script>
